import zhEvent from "../../define/zhEvent"

class zhLine extends Konva.Group{
	constructor(config,info) {

		super(config);

		this.info = info
		this.uniqueId = this.info.uniqueId

		if(this.CreateObject)this.CreateObject(config);
	}
	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	// ********** 节点周期函数扩展
	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	destroy()
	{
		this.RemoveEvent();
		super.destroy();
	}

	
	RemoveEvent()
	{
		this.off("dragstart")
		this.off("dragmove")
		this.off("dragend")
	}


	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	// ********** 绑定点信息
	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	// 绑定点信息
	TieWithPoints(points)
	{
		this.points = points;
		this.PointsDirtyStart();

		if(this.UpDateLine)this.UpDateLine();
	}


	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	// ********** 根据点的dirty标志判断是否需要刷新
	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	IsNeedUpdate()
	{
		for (let index = 0; index < this.points.length; index++) {
			if(this.points[index].IsInfoDirty()) return true;
		}
		return false;
	}

	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	// ********** 开启所有点 dirty标志
	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	PointsDirtyStart()
	{
		for (let index = 0; index < this.points.length; index++) {
			this.points[index].SetInfoDirty(true);			
		}
	}

	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	// ********** 关闭所有点 dirty标志
	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	PointsDirtyFinish()
	{
		for (let index = 0; index < this.points.length; index++) {
			this.points[index].SetInfoDirty(false);			
		}
	}

}

export default zhLine;