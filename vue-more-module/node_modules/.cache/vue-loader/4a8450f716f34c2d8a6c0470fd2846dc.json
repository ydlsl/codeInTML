{"remainingRequest":"/home/yd/company/demo/vue-cli3/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/yd/company/demo/vue-cli3/src/pc-project/components/aoto-query/fj-auto-complete.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/home/yd/company/demo/vue-cli3/src/pc-project/components/aoto-query/fj-auto-complete.vue","mtime":1644831193685},{"path":"/home/yd/company/demo/vue-cli3/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/yd/company/demo/vue-cli3/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/yd/company/demo/vue-cli3/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/home/yd/company/demo/vue-cli3/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/yd/company/demo/vue-cli3/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCmltcG9ydCB7IENvbXBvbmVudCwgVnVlLCBQcm9wLCBFbWl0LCBNb2RlbCB9IGZyb20gJ3Z1ZS1wcm9wZXJ0eS1kZWNvcmF0b3InOwppbXBvcnQgeyBnZXRQb3MsIHN0b3BQcm9wYWdhdGlvbiwgZGVib3VuY2UgfSBmcm9tICdAL3V0aWxzJzsKaW1wb3J0IHtzZXJ2aWNlfSBmcm9tICdAL3BjLXByb2plY3Qvc2VydmljZXMvaW50ZXJmYWNlcyc7CgovKioKICogPHNsb3Q+5LiK55qE6Ieq5a6a5LmJ5bGe5oCn77yM5Y+v5Lul5Zyo54i257uE5Lu25LiK5L2/55SoIDx0ZW1wbGF0ZSB2LXNsb3Q6YW90bz0ic2xvdFByb3BzIj57e3Nsb3RQcm9wcy5pdGVtfX08L3RlbXBsYXRlPiDojrflj5YKICogQGluaXQoZXZlbnQ6IGFueSwgbW9kZWxOYW1lOiBhbnkpICDniLbnu4Tku7bopoHosIPnlKjmraTmlrnms5XvvIznqb/lpoJldmVudOS7peWPinYtbW9kZWznmoTlsZ7mgKflkI3miJAKICogQGxpc3RTdHlsZeaOp+WItuW9k+WJjee7hOS7tueahOS9jee9rgogKiBAc2VsZWN0S2V5IOmAieS4reeahOmhueeahOWtl+auteWQjeensAogKiBAcmVxdWVzdEV2ZW50IOeItuS8oOi/h+adpeeahOivt+axguaVsOaNruaWueazlSBGdW5jdGlvbgogKi8KCkBDb21wb25lbnQKZXhwb3J0IGRlZmF1bHQgY2xhc3MgRmpBdXRvQ29tcGxldGVDb21wb25lbnQgZXh0ZW5kcyBWdWUgewogICAgQE1vZGVsKCdjaGFuZ2UnLCB7IHR5cGU6IFN0cmluZyB9KSByZWFkb25seSBzZWFyY2hDb2RlITogc3RyaW5nOwogICAgQFByb3AoKSBwcml2YXRlIHJlcXVlc3RFdmVudCE6IEZ1bmN0aW9uOwogICAgQFByb3AoeyBkZWZhdWx0OiAnTmFtZScsIHR5cGU6IFN0cmluZyB9KSBwcml2YXRlIHNlbGVjdEtleSE6IHN0cmluZzsKICAgIAogICAgcHJpdmF0ZSBsaXN0U3R5bGU6IGFueSA9IHsgJ3BvaW50ZXItZXZlbnRzJzogJ2F1dG8nIH07CiAgICBwcml2YXRlIGJveFNob3cgPSBmYWxzZTsKICAgIHByaXZhdGUgQWxsRGF0YTogYW55W10gPSBbXTsKICAgIHByaXZhdGUgYW90b2VtcHR5aXNTaG93ID0gZmFsc2U7CgogICAgQEVtaXQoJ2NoYW5nZScpIHByaXZhdGUgY2hhbmdlRW1pdChldmVudDogYW55KSB7fQoKICAgIHByaXZhdGUgc2VsZWN0TmFtZShpdGVtOiBhbnkpIHsgCiAgICAgICAgdGhpcy5jaGFuZ2VFbWl0KGl0ZW1bdGhpcy5zZWxlY3RLZXldKTsKICAgICAgICB0aGlzLmJveFNob3cgPSBmYWxzZTsKICAgIH0KICAgICAgIAogICAgY3JlYXRlZCgpIHsKICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsICgpID0+IHsgdGhpcy5ib3hTaG93ID0gZmFsc2U7fSk7CiAgICB9CgogICAgZ2V0dGhpcygpIHsgcmV0dXJuIHRoaXM7IH0KICAgIGlucHV0SGFuZGxlID0gZGVib3VuY2UoKGV2ZW50OiBhbnksIG1vZGVsOmFueSkgPT4gewogICAgICAgIGNvbnN0IHRoYXQgPSB0aGlzLmdldHRoaXMoKTsgLy8g55Sx5LqO5L2/55SoIGZuID0gKCkgPT4ge30g5Lya5a+86Ie0dGhpc+WkseaViO+8jOWFiOS9v+eUqOatpOaWueazleS7o+abv3RoaXPvvIzlkI7pnaLkvJjljJYKICAgICAgICB0aGF0LmluaXQoZXZlbnQpOwogICAgICAgIHRoYXQuQWxsRGF0YSA9IFtdOwogICAgICAgIHRoYXQuYW90b2VtcHR5aXNTaG93ID0gZmFsc2U7CiAgICAgICAgdGhpcy5jaGFuZ2VFbWl0KGV2ZW50LnRhcmdldC52YWx1ZSk7CiAgICB9LDEwMDApCgogICAgY2xpY2tIYW5kbGUoZXZlbnQ6IGFueSkgewogICAgICAgIHRoaXMuaW5pdChldmVudCk7CiAgICAgICAgdGhpcy5ib3hTaG93ID0gZmFsc2U7CiAgICAgICAgc2V0VGltZW91dCgoKT0+ewogICAgICAgICAgICBzdG9wUHJvcGFnYXRpb24oZXZlbnQpOwogICAgICAgICAgICB0aGlzLmJveFNob3cgPSB0cnVlOwogICAgICAgIH0sMTAwKQogICAgfQoKICAgIGluaXQoZXZlbnQ6IGFueSkgewogICAgICAgIGNvbnN0IGRvbSA9IGV2ZW50LnRhcmdldDsKICAgICAgICBjb25zdCBfZ2V0UG9zID0gZ2V0UG9zKGRvbSk7CiAgICAgICAgdGhpcy5saXN0U3R5bGUgPSB7CiAgICAgICAgLi4udGhpcy5saXN0U3R5bGUsCiAgICAgICAgJ3dpZHRoJzogYCR7X2dldFBvcy53aWR0aH1weGAsCiAgICAgICAgJ2xlZnQnOiBgJHtfZ2V0UG9zLmxlZnR9cHhgLAogICAgICAgICd0b3AnOiBgJHtfZ2V0UG9zLnRvcCtfZ2V0UG9zLmhlaWdodH1weGAsCiAgICAgICAgfQogICAgICAgIHRoaXMuYm94U2hvdyA9IHRydWU7CiAgICAgICAgaWYodGhpcy5yZXF1ZXN0RXZlbnQpewogICAgICAgICAgICB0aGlzLnJlcXVlc3RFdmVudChldmVudC50YXJnZXQudmFsdWUsIChyZXM6IGFueSkgPT4gewogICAgICAgICAgICAgICAgdGhpcy5BbGxEYXRhID0gcmVzOwogICAgICAgICAgICAgICAgaWYodGhpcy5BbGxEYXRhLmxlbmd0aCA9PT0gMCl7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hb3RvZW1wdHlpc1Nob3cgPSB0cnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgCiAgICB9CiAgICBib3hFdmVudChldmVudDogYW55KSB7CiAgICAgICAgc3RvcFByb3BhZ2F0aW9uKGV2ZW50KTsKICAgIH0KfQo="},{"version":3,"sources":["fj-auto-complete.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAgBA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"fj-auto-complete.vue","sourceRoot":"src/pc-project/components/aoto-query","sourcesContent":["<template>\n    <div>\n        <input type=\"text\" :value=\"searchCode\" @input=\"inputHandle($event)\" @click=\"clickHandle($event)\" />\n        <div class=\"aoto-query\" :style=\"listStyle\" v-if=\"boxShow\" @click=\"boxEvent\">\n            <div v-if=\"!AllData.length && !aotoemptyisShow\">加载中。。。</div>\n            <div v-if=\"searchCode!==''&&aotoemptyisShow\">暂无更多数据</div>\n            <template v-if=\"AllData.length\">\n            <div v-for=\"(aotoitem, index) of AllData\" :key=\"index\" @click=\"selectName(aotoitem)\">\n                <slot name=\"aoto\" :item=\"aotoitem\"></slot>\n            </div>\n            </template>\n        </div>\n    </div>\n</template>\n\n<script lang=\"ts\">\nimport { Component, Vue, Prop, Emit, Model } from 'vue-property-decorator';\nimport { getPos, stopPropagation, debounce } from '@/utils';\nimport {service} from '@/pc-project/services/interfaces';\n\n/**\n * <slot>上的自定义属性，可以在父组件上使用 <template v-slot:aoto=\"slotProps\">{{slotProps.item}}</template> 获取\n * @init(event: any, modelName: any)  父组件要调用此方法，穿如event以及v-model的属性名成\n * @listStyle控制当前组件的位置\n * @selectKey 选中的项的字段名称\n * @requestEvent 父传过来的请求数据方法 Function\n */\n\n@Component\nexport default class FjAutoCompleteComponent extends Vue {\n    @Model('change', { type: String }) readonly searchCode!: string;\n    @Prop() private requestEvent!: Function;\n    @Prop({ default: 'Name', type: String }) private selectKey!: string;\n    \n    private listStyle: any = { 'pointer-events': 'auto' };\n    private boxShow = false;\n    private AllData: any[] = [];\n    private aotoemptyisShow = false;\n\n    @Emit('change') private changeEmit(event: any) {}\n\n    private selectName(item: any) { \n        this.changeEmit(item[this.selectKey]);\n        this.boxShow = false;\n    }\n       \n    created() {\n        document.addEventListener(\"click\", () => { this.boxShow = false;});\n    }\n\n    getthis() { return this; }\n    inputHandle = debounce((event: any, model:any) => {\n        const that = this.getthis(); // 由于使用 fn = () => {} 会导致this失效，先使用此方法代替this，后面优化\n        that.init(event);\n        that.AllData = [];\n        that.aotoemptyisShow = false;\n        this.changeEmit(event.target.value);\n    },1000)\n\n    clickHandle(event: any) {\n        this.init(event);\n        this.boxShow = false;\n        setTimeout(()=>{\n            stopPropagation(event);\n            this.boxShow = true;\n        },100)\n    }\n\n    init(event: any) {\n        const dom = event.target;\n        const _getPos = getPos(dom);\n        this.listStyle = {\n        ...this.listStyle,\n        'width': `${_getPos.width}px`,\n        'left': `${_getPos.left}px`,\n        'top': `${_getPos.top+_getPos.height}px`,\n        }\n        this.boxShow = true;\n        if(this.requestEvent){\n            this.requestEvent(event.target.value, (res: any) => {\n                this.AllData = res;\n                if(this.AllData.length === 0){\n                    this.aotoemptyisShow = true;\n                }\n            });\n        }\n        \n    }\n    boxEvent(event: any) {\n        stopPropagation(event);\n    }\n}\n</script>\n\n<style scoped lang=\"less\">\n.aoto-query{position:absolute;background: #fff;box-shadow: 0px 5px 38px #ccc;}\n</style>\n\n"]}]}