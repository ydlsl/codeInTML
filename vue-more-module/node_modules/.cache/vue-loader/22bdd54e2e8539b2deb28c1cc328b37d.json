{"remainingRequest":"/home/yd/company/demo/vue-cli3/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/yd/company/demo/vue-cli3/src/pc-project/components/select-city.vue?vue&type=style&index=0&id=42d4ca2c&scoped=true&lang=less&","dependencies":[{"path":"/home/yd/company/demo/vue-cli3/src/pc-project/components/select-city.vue","mtime":1644831193685},{"path":"/home/yd/company/demo/vue-cli3/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/yd/company/demo/vue-cli3/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/yd/company/demo/vue-cli3/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/yd/company/demo/vue-cli3/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/yd/company/demo/vue-cli3/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/yd/company/demo/vue-cli3/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLnNlbGVjdC1jaXR5e3Bvc2l0aW9uOiBhYnNvbHV0ZTtmb250LXNpemU6MTJweDtib3gtc2hhZG93OiAwcHggNXB4IDM4cHggI2NjYztiYWNrZ3JvdW5kOiNmZmY7CiAgLmNsaWNrLWNpdHl7YmFja2dyb3VuZDogI2ZmZjt3aWR0aDoyOTBweDt9CiAgLmlucHV0LWNpdHl7YmFja2dyb3VuZDogI2ZmZjt3aWR0aDoyMDBweDttYXgtaGVpZ2h0OiAzMDBweDtvdmVyZmxvdy15OiBhdXRvOwogICAgLm5hbWUtaXRlbXtwYWRkaW5nOjNweDsgY3Vyc29yOiBwb2ludGVyO30KICB9CiAgLm5hbWV7cGFkZGluZzo4cHg7ZGlzcGxheTogaW5saW5lLWJsb2NrO2N1cnNvcjogcG9pbnRlcjt9CiAgLnRpdGxle2JvcmRlci1ib3R0b206MXB4IHNvbGlkICNkOGQ4ZDg7CiAgICAudGl0e3BhZGRpbmc6MCA1cHg7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgI2Q4ZDhkODtkaXNwbGF5OmlubGluZS1ibG9jaztsaW5lLWhlaWdodDoyNHB4O2N1cnNvcjogcG9pbnRlcjsKICAgICAgcG9zaXRpb246IHJlbGF0aXZlO2JvdHRvbTotMXB4OwogICAgICAmLmFjdGl2ZXtib3JkZXI6MXB4IHNvbGlkICNkZGQ7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgI2ZmZjt9CiAgICB9CiAgfQogIC5zcGxpdC1ib3h7YmFja2dyb3VuZDogI2ZmZjsKICAgIC5sZXR0ZXItdGl0e2Zsb2F0OiBsZWZ0O3dpZHRoOjIwcHg7dGV4dC1hbGlnbjogY2VudGVyO2NvbG9yOiNmZjZlMDA7cGFkZGluZy10b3A6MTBweDt9CiAgICAubGV0dGVyLWNvbntmbG9hdDogbGVmdDt3aWR0aDogMjY4cHg7fQogIH0KCn0K"},{"version":3,"sources":["select-city.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"select-city.vue","sourceRoot":"src/pc-project/components","sourcesContent":["<template>\n  <div>\n    <input type=\"text\" \n    :value=\"searchCode\" \n    @input=\"inputHandle($event)\"\n    @click=\"clickHandle($event)\"\n    />\n    <div class=\"select-city\" :style=\"listStyle\" @click=\"boxEvent\">\n      <div v-if=\"(clickboxShow || inputboxShow)&&allCity.length === 0\">加载中...</div>\n\n      <div class=\"click-city\" v-if=\"clickboxShow && allCity.length\">\n        <div class=\"title\">\n          <span class=\"tit\" :class=\"selectedKey === '热门'?'active':''\" @click=\"select('热门')\">热门</span>\n          <span class=\"tit\" :class=\"selectedKey === key?'active':''\" v-for=\"(value,key,index) of splitCityList\" :key=\"index\" @click=\"select(key)\">\n            {{key}}\n          </span>\n        </div>\n        <div class=\"split-box hot\">\n          <template v-if=\"selectedKey === '热门'\">\n            <span class=\"name\" v-for=\"(item, index) of hotCity\" :key=\"index\" @click=\"checkName(item)\">{{item.Name}}</span>\n          </template>\n        </div>\n        <div class=\"split-box\" v-for=\"(value,key,index) of splitCityList\" :key=\"index\">\n          <!-- <div class=\"split-tit\">{{key}}</div> -->\n          <template v-if=\"selectedKey === key\">\n            <div v-for=\"(value1,key1,index1) of value\" :key=\"index1\">\n              <div class=\"letter-box clearFix\">\n                <div class=\"letter-tit\">{{key1}}</div>\n                <div class=\"letter-con\">\n                  <span class=\"name\" v-for=\"(item2,index2) of value1\" :key=\"index2\" @click=\"checkName(item2)\">{{item2.Name}}</span>\n                </div>\n              </div>\n            </div>\n          </template>\n        </div>\n      </div>\n\n      <div class=\"input-city\" v-if=\"inputboxShow && allCity.length\">\n        <div v-if=\"!inputAllCity.length\">暂无更多数据</div>\n        <template v-if=\"inputAllCity.length\">\n          <div class=\"name-item\" v-for=\"(item, index) of inputAllCity\" :key=\"index\"  @click=\"checkName(item)\">{{item.Name}}</div>\n        </template>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { Component, Vue, Prop, Emit, Model } from 'vue-property-decorator';\nimport {service} from '@/pc-project/services/interfaces'\nimport { getPos, stopPropagation } from '@/utils';\n\n/**\n * @init(event: any)  初始要调用此方法\n * @listStyle控制当前组件的位置\n * selected emit事件\n */\n\n@Component\nexport default class SelectCityComponent extends Vue {\n  @Model('change', { type: String }) readonly searchCode!: string\n\n  private listStyle: any = { 'pointer-events': 'auto' };\n  private clickboxShow = false; // 点击面板是否显示\n  private inputboxShow = false; // 输入面板是否显示\n  private allCity: any[] = []; // 所有城市\n  private inputAllCity: any[] = []; // 输入的时候显示的列表\n  private selectedKey = '热门';\n  private hotCity: any[] = []; // 热门城市列表\n  private splitCityList: any = { // A-Z面板列表\n      'ABC': {},\n      'DEFG': {},\n      'HJ': {},\n      'KL': {},\n      'MNPQ': {},\n      'RSTW': {},\n      'XYZ': {},\n  }\n\n  @Emit('selected') private checkName(item: any) {\n    this.clickboxShow = false;\n    this.inputboxShow = false;\n    this.changeEmit(item.Name);\n  }\n\n  @Emit('change') private changeEmit(event: any) {}\n\n  public inputHandle(event: any): void {\n    this.changeEmit(event.target.value);\n    this.init(event);\n  }\n\n  clickHandle(event: any): void {\n    // this.changeEmit(event.target.value);\n    this.init(event);\n\n    this.clickboxShow = false;\n    setTimeout(()=>{\n      stopPropagation(event);\n      this.clickboxShow = true;\n    },100)\n    this.inputboxShow = false;\n  }\n\n  created() {\n    service.request({\n        url: `/Cities`,\n        data: {},\n        notLoading: true\n    }).then((res: any) => {\n      this.allCity = res;\n      const allCityList: any = {}; // 所有城市\n      this.allCity.forEach((item, index) => {\n        if(item.IsHot){\n            this.hotCity.push(item);\n          }\n          const letter = item.Abbreviation.substr(0,1);\n          if(item.Level === 1){\n            if(!allCityList[letter]){ allCityList[letter] = [] };\n            allCityList[letter].push(item);\n          }\n      })\n      \n      for(let key in allCityList) {\n          for(let key2 in this.splitCityList) {\n            if(key2.indexOf(key)!==-1) { // 存在\n            if(!this.splitCityList[key2][key]){this.splitCityList[key2][key] = []}\n              this.splitCityList[key2][key] = allCityList[key];\n            }\n          }\n      }\n    });\n    document.addEventListener(\"click\", () => {\n      this.clickboxShow = false;\n      this.inputboxShow = false;\n    })\n  }\n\n  select(key: string) {\n    this.selectedKey = key;\n    console.log(this.selectedKey);\n  }\n\n  // 父组件调用\n  init(event: any) {\n    this.selectedKey = '热门';\n    const dom = event.target;\n    const _getPos = getPos(dom);\n    this.listStyle = {\n      ...this.listStyle,\n      // 'width': `${_getPos.width}px`,\n      'left': `${_getPos.left}px`,\n      'top': `${_getPos.top+_getPos.height}px`,\n    }\n\n    if(event.type === 'input'){\n      this.input(dom.value);\n    }\n  }\n\n  input(value: string) {\n    this.clickboxShow = false;\n    this.inputboxShow = true;\n    this.inputAllCity = this.allCity.filter(\n      item => item.Name.indexOf(value)===0 || \n      item.Pinyin.indexOf(value.toUpperCase())===0 ||\n      item.Abbreviation.indexOf(value.toUpperCase())===0\n      );\n  }\n\n  boxEvent(event: any) {\n    stopPropagation(event);\n  }\n}\n</script>\n\n<style scoped lang=\"less\">\n.select-city{position: absolute;font-size:12px;box-shadow: 0px 5px 38px #ccc;background:#fff;\n  .click-city{background: #fff;width:290px;}\n  .input-city{background: #fff;width:200px;max-height: 300px;overflow-y: auto;\n    .name-item{padding:3px; cursor: pointer;}\n  }\n  .name{padding:8px;display: inline-block;cursor: pointer;}\n  .title{border-bottom:1px solid #d8d8d8;\n    .tit{padding:0 5px;border-bottom:1px solid #d8d8d8;display:inline-block;line-height:24px;cursor: pointer;\n      position: relative;bottom:-1px;\n      &.active{border:1px solid #ddd;border-bottom:1px solid #fff;}\n    }\n  }\n  .split-box{background: #fff;\n    .letter-tit{float: left;width:20px;text-align: center;color:#ff6e00;padding-top:10px;}\n    .letter-con{float: left;width: 268px;}\n  }\n\n}\n</style>\n\n"]}]}